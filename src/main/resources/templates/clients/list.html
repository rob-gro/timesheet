<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{head :: head}">
    <!-- Fallback content -->
</head>
<body>
<!-- Back button icon (mobile only, fixed position) -->
<button type="button" class="mobile-back-btn" onclick="window.location.href='/'" aria-label="Back to main menu">
    ←
</button>

<div class="container mt-5">
    <div class="card">
        <div class="container my-auto mx-auto">
            <h2 class="text-center mb-4">Edit Clients Details</h2>

            <div class="mb-3">
                <button type="button" class="nav-button" onclick="window.location.href='/clients/new';">Add New Client
                </button>
                <button type="button" class="nav-button" onclick="window.location.href='/';">Back to Main
                </button>
            </div>

            <div>
                <table class="table clients-table">
                    <colgroup>
                        <col style="width: 30%">
                        <col style="width: 20%">
                        <col style="width: 12%">
                        <col style="width: 10%">
                        <col style="width: 28%">
                    </colgroup>
                    <thead>
                    <tr>
                        <th>Client Name</th>
                        <th>Email</th>
                        <th>Rate (£)</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="client : ${clients}"
                        th:data-client-id="${client.id}"
                        th:style="${!client.active} ? 'opacity: 0.6; background-color: #2a2a2a;' : ''">
                        <td data-label="Client Name">
                            <span class="cell-value" th:text="${client.clientName}"></span>
                        </td>
                        <td data-label="Email">
                            <span class="cell-value" th:text="${client.email}"></span>
                        </td>
                        <td data-label="Rate (£)">
                            <span class="cell-value" th:text="${client.hourlyRate}"></span>
                        </td>
                        <td data-label="Status">
                            <span class="cell-value">
                                <span th:if="${client.active}" class="badge-success">Active</span>
                                <span th:unless="${client.active}" class="badge-danger">Inactive</span>
                            </span>
                        </td>
                        <td data-label="Actions">
                            <div class="cell-actions">
                                <button class="save-button"
                                        th:onclick="'window.location.href=\'/clients/edit/' + ${client.id} + '\''">
                                    Edit
                                </button>

                                <button th:if="${client.active}"
                                        class="del-button"
                                        th:onclick="'toggleClientActive(' + ${client.id} + ', false)'">
                                    Deactivate
                                </button>

                                <button th:unless="${client.active}"
                                        class="save-button"
                                        th:onclick="'toggleClientActive(' + ${client.id} + ', true)'"
                                        sec:authorize="hasRole('ADMIN')">
                                    Activate
                                </button>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script th:src="@{/js/clients.js}"></script>

</body>
</html>
